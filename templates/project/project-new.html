{% extends 'base.html' %}
{% load static %}

{% block head %}
  <link rel="stylesheet" href="{% static  'css/untitled.css' %}">
{% endblock %}

{% block content %}
{% if user.is_authenticated %}
    <main class="page contact-page">
        <section class="portfolio-block">
            <div class="container">
                <div class="heading">
                    <h2>Create Project</h2>
                </div>
                <form id="search-form" method="post" action="/api/search/">
                    {% csrf_token %}
                    <p>Search for keywords to get the data from X platform and research.</p>
                    <div class="form-group"><label class="text-primary" for="name">Project Name</label>
                        <input
                                class="form-control item" required type="text" id="name" name="name"></div>
                    <div id="search-bars-container">
                        <div class="form-group search-bar">
                            <input type="text" class="form-control item" name="keywords" placeholder="Enter keyword" required>
                        </div>
                    </div>
                        <button type="button" class="btn btn-secondary" id="add-search-bar">+</button>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-block btn-lg">Create Project</button>
                    </div>
                </form>
                <form enctype="multipart/form-data" method="post">
                    {% csrf_token %}
                    <p>Upload all of your files to create a corpus and research.</p>
                    <div class="form-group"><label class="text-primary" for="name">Project Name</label>
                        <input
                                class="form-control item" required type="text" id="name" name="name"></div>
                    <div class="form-group">
                        <label class="text-primary" for="file-list">
                            File List (allowed files .pdf .txt)
                        </label>
                        <input type="file" id="file-list" class="form-control item" required name="files"
                               accept=".pdf,.txt" multiple></div>
<!--                    <div class="form-group">-->
<!--                        <input type="hidden" class="form-control item" id="author" value="" >-->
<!--                    </div>-->
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-block btn-lg" role="button">Create
                            Project
                        </button>
                    </div>
                </form>
                <form enctype="multipart/form-data" method="post">
                    {% csrf_token %}
                    <p>Upload a folder to create a corpus and research.</p>
                    <div class="form-group"><label class="text-primary" for="folder-name">Project Name</label>
                        <input
                                class="form-control item" required type="text" id="folder-name" name="folder_name"></div>
                    <div class="form-group">
                        <label class="text-primary" for="folder-file-list">
                            File List (allowed files .pdf .txt)
                        </label>
                        <input type="file" id="folder-file-list" class="form-control item" required name="folder_files"
                               accept=".pdf,.txt" multiple webkitdirectory></div>
<!--                    <div class="form-group">-->
<!--                        <input type="hidden" class="form-control item" id="author" value="" >-->
<!--                    </div>-->
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-block btn-lg" role="button">Create
                            Project
                        </button>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <script>
        document.getElementById('add-search-bar').addEventListener('click', function () {
            const container = document.getElementById('search-bars-container');
            const newSearchBar = document.createElement('div');
            newSearchBar.classList.add('form-group', 'search-bar');
            newSearchBar.innerHTML = '<div class="input-group"><input type="text" class="form-control item" name="keywords" placeholder="Enter keyword" required><button type="button" class="btn btn-danger remove-search-bar" style="margin-left: 10px;">-</button></div>';
            container.appendChild(newSearchBar);

            // Add event listener to the remove button
            newSearchBar.querySelector('.remove-search-bar').addEventListener('click', function () {
                newSearchBar.remove();
            });
        });

        // Add event listener to existing remove buttons (if any)
        document.querySelectorAll('.remove-search-bar').forEach(button => {
            button.addEventListener('click', function () {
                button.parentElement.parentElement.remove();
            });
        });
    </script>

<!--    <script >-->
<!--        var name = "{{ user.id }}" ;-->
<!--        document.getElementById("author").value = name;-->
<!--    </script>-->

{% else %}
    <div class = "container" style= "margin-top : 100px;" >
        <h3>You cannot create a project without logged in! </h3> <br />
        <a class="btn btn-primary" href="{% url 'login' %}" role="button">Login</a>
    </div>
    <br />
{% endif %}

{% endblock %}
