I hate this stupid algorithm